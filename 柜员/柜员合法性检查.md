#角色
    你是一名资深银行核心业务系统开发人员
#我的需求
    进行柜员合法性检查

#我的实现
## 柜员状态检查
    1、根据【柜员号】查询柜员参数表
        （1）查询无记录时，则报错“柜员号在系统中不存在”
        （2）否则，获取柜员状态，检查柜员状态是否正常，柜员状态非正常时报错“状态非正常，系统中为xxx”
## 检查柜员密码是否到期
    1、获取柜员参数表的密码到期日期
        （1）根据柜员参数表的密码修改日期和密码有效天数，计算密码到期日期
        （2）检查密码到期日期是否小于交易日期，如果是，则报错密码已过期，请修改密码

请将上述内容以业务需求的方式转述给我，仅限于上述内容，不需要扩展

你是一名资深银行核心业务系统开发人员
柜员合法性检查
1、检查柜员是否存在
2、检查柜员状态是否正常
3、检查柜员密码是否到期
4、检查柜员权限
5、更新柜员登录状态
请将上述内容以业务需求的方式转述给我，分为 业务检査规则 和 业务处理规则 两大类


我需要把下列规则转换成新的规则样式，分为 业务检査规则 和 业务处理规则 两大类：
业务检査规则
柜员存在性检查
柜员密码有效期检查
...检查类型可按需扩展

业务处理规则
柜员签到处理
...处理类型可按需扩展



活动名称:柜员签到
任务:柜员合法性检查
处理规则: 
1.根据【柜员号】查询柜员参数表
1.1.查询无记录时，则报错“柜员号在系统中不存在”
1.2.否则，获取柜员状态，检查柜员状态是否正常，柜员状态非正常时报错“状态非正常，系统中为xxx”
2.检查柜员密码是否到期
2.1.获取柜员参数表的密码到期日期
2.2.根据柜员参数表的密码修改日期和密码有效天数，计算密码到期日期
2.3.检查密码到期日期是否小于交易日期，如果是，则报错密码已过期，请修改密码
任务:更新柜员签到
处理规则: 
3.更新柜员登录状态
3.1根据柜员号查询柜员参数表
3.2设置柜员登录状态为签到，更新柜员参数表


转换示例输出
1.柜员存在性检查
1.1.根据【柜员号】查询柜员参数表
1.2.查询无记录时，则报错“柜员号在系统中不存在”
1.3.否则，获取柜员状态，检查柜员状态是否正常，柜员状态非正常时报错“状态非正常，系统中为xxx”
2.柜员密码有效期检查
2.1.获取柜员参数表的密码到期日期
2.2.根据柜员参数表的密码修改日期和密码有效天数，计算密码到期日期
2.3.检查密码到期日期是否小于交易日期，如果是，则报错密码已过期，请修改密码
3.更新柜员签到
3.1根据柜员号查询柜员参数表
3.2设置柜员登录状态为签到，更新柜员参数表


### **业务检查规则**

1. **柜员存在性检查**  
   1.1 根据【柜员号】查询柜员参数表 `ktlp_gycshu`（需校验记录状态 `JILUZTAI = '0'`）  
   1.2 若未查询到对应记录，则返回错误信息：“柜员号在系统中不存在”  
   1.3 若查询到记录，则获取柜员状态 `GUIYZTAI`，判断其是否为 `'0'`（正常）  
   1.4 若柜员状态不为 `'0'`，则返回错误信息：“状态非正常，系统中为xxx”（其中 `xxx` 为实际状态值）

2. **柜员密码有效期检查**  
   2.1 获取柜员参数表中的“密码修改日期”（`MIMARIQI`）和“密码有效天数”（`MIMAYXTS`）  
   2.2 计算密码到期日期：`到期日期 = MIMARIQI + MIMAYXTS`（以天为单位的日期运算）  
   2.3 比较密码到期日期与当前交易日期：  
       若到期日期 < 交易日期，则返回错误信息：“密码已过期，请修改密码”

3. **柜员权限检查**  
   3.1 获取柜员参数表中的“柜员权限状态”字段 `GUIYQXZT`  
   3.2 判断 `GUIYQXZT` 是否为 `'0'`（正常），若不是，则返回错误信息：“权限状态异常，系统中为xxx”（其中 `xxx` 为实际权限状态值）  
   3.3 获取柜员的角色代码 `JIAOSEDM` 和交易组别列表 `JOYIZBLB`、产品交易列表 `CPJYLBIO` 等权限相关信息  
   3.4 根据当前交易类型或操作需求，检查该柜员是否具有相应的角色或权限：  
       - 如果柜员的角色代码不在允许执行当前交易的角色列表中，或者没有相应的交易组别或产品权限，则返回错误信息：“权限不足，无法执行此操作”

---

### **业务处理规则**

更新柜员签到  
1.1 根据【柜员号】查询柜员参数表 `ktlp_gycshu`  

1.2 更新以下字段：  
- `GUIYDLZT`（柜员签到状态）设置为 `'0'`（签到）  
- `QIANDSJI`（签到时间）设置为当前系统时间戳  
- `ZHONGDHA`（终端号）  
- `IPDIZHII`（IP地址）等登录信息可同步更新（如需）

1.3 执行数据库更新操作，持久化柜员签到状态




